package com.adenon.sp.streams;

import java.util.UUID;

import javax.persistence.EntityManager;

import com.adenon.sp.executer.IExecuterManager;
import com.adenon.sp.kernel.osgi.activator.BundleActivator;
import com.adenon.sp.persistence.IJpaProvider;
import com.adenon.sp.persistence.SystemPool;


public class StreamsActivator extends BundleActivator {

    @Override
    protected void start() throws Exception {
        this.getService(IExecuterManager.class);
        this.registerService(IStreamService.class, new StreamService(this.services));
        final EntityManager em = this.getService(IJpaProvider.class).entityManager(SystemPool.STATS);
        this.test(em);
    }

    private void test(final EntityManager entityManager) {
        entityManager.getTransaction().begin();
        final Streams hub = new Streams(UUID.randomUUID().toString());
        entityManager.persist(hub);
        entityManager.getTransaction().commit();
    }

    @Override
    protected void stop() throws Exception {

    }

}
